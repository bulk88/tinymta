<html manifest="ac.appcache"><head>
<!-- put no-referrer so preload reqs match later fetch reqs instead of double req -->
<meta name=mobileoptimized content=0><meta name="referrer" content="no-referrer">
<link href="//collector-otp-prod.camsys-apps.com" rel="dns-prefetch">
<link href="//collector-otp-prod.camsys-apps.com" rel="preconnect" crossorigin>
<link href="https://api.weather.com" rel="dns-prefetch">
<link href="https://api.weather.com" rel="preconnect" crossorigin>
<link href=stations.htm rel=prefetch>
<link href=mn/stations.htm rel=prefetch>
<link href=li/stations.htm rel=prefetch>
<link href=status.htm rel=prefetch>
<link href=routes.js rel=prefetch crossorigin>
<title>tinymta - Lightweight NYC MTA Subway Train arrival times</title>
</head><body>
Do you have a<br>
[1]<a accesskey=1 href=stations.htm>Smart Phone (Subway)</a><br>
[2]<a accesskey=2 href=mn/stations.htm>Smart Phone (Metro North)</a><br>
[3]<a accesskey=3 href=li/stations.htm>Smart Phone (Long Island)</a><br>
[4]<a accesskey=4 href=jsrdt.htm>Dumb Phone (Subway)</a><br>
[5]<a accesskey=5 href=mn/rt.htm>Dumb Phone (Metro North)</a><br>
[6]<a accesskey=6 href=li/jsrdt.htm>Dumb Phone (Long Island)</a><br>
[7]<a accesskey=7 href=status.htm>Service Changes</a><br>
<!-- [8]<a accesskey=8 href=plan.htm>Smart Phone UI (Subway) Trip Planner</a><br> -->
<!-- [9]<a accesskey=9 href=more.htm>More</a><br> -->
[0]<a accesskey=0 href=README.html>About</a><br>
<!-- get I/O on wire first -->
<script async src=as.js></script>
<script async src=dumb.js></script>
<br>
<script>
//>C29, E12, F4, O16, SF8, IE never
//var se = document.currentScript;
var se = document.scripts[document.scripts.length - 1]
var jsonp;
if (typeof fetch !== 'function') {
  fetch = function (url) {
    return {
      then: function (cb) {
        cb({
          json: function () {
            return {
              then: function (cb, addIMS /*spec breaking, shud be reject cb*/) {
                var this_func = this.then; /*xhr cb has differnt this obj than here*/
                var x = window.XMLHttpRequest ? new window.XMLHttpRequest() : new ActiveXObject("Microsoft.XMLHTTP");
                try {
                  /*throw (0);*/
                  /* on Fast refresh, on CORS enabled browsers, a traintime.lirr.org XHR req
                  will happen over network, once browser sees no Access Control header
                  it will "fail" the req to the page, then the page does the JSONP network
                  request, stop this double request thing to save network traffic after CORS
                  fails the 1st time, the server wont magically get the header one minute.
                  Once CORS fails once, it will never succeed on that particular client, so
                  never try a CORS request again.
                  Browsers without CORS like Opera 10, fail the XHR req, instantly, client
                  side, without network traffic.*/
                  if (jsonp)
                    throw (0);
                  /*open() can fire errors events or throw exceptions*/
                  x.open('get', url, 1);
                  try {
                    x.responseType = 'json';
                  } catch (e) {
                    //old chromes throw "SYNTAX_ERR: DOM Exception 12" if no XHR JSON
                  }
                  /* handler assignment can't be factored to root or IE6 desktop and IE6 mobile
                  wont drawn train times using "Fast" beyond the 1st/initial page load
                  and only "Slow" works
                  http://keelypavan.blogspot.com/2006/03/reusing-xmlhttprequest-object-in-ie.html*/
                  x.onreadystatechange = function () {
                    if (x.readyState == 4) {
                      if (x.status == 200) {
                        /* IE 6 cache hit, no IP traffic happened, thats bad,
                        this detects it and resends it, on Chrome with CORS
                        XMLHttpRequest cannot load //mtasubwaytime.info/getTime/E/G14. Request header field If-Modified-Since is not allowed by Access-Control-Allow-Headers in preflight response.
                        so include IMS header ONLY if IE with cache bug by feature test and no CORS support

                        asking CORS chrome for the Date header causes "Refused to get unsafe header "Date"" and empty header value
                        which would trigger the IE 6 retry, but dont do the IE6 retry on chrome, so test first for CORS
                         */
                        if ('withCredentials' in x || x.getResponseHeader("Date")) {
                          x = x.response || x.responseText;
                          cb(typeof(x) === 'object' ? x : window.JSON ? JSON.parse(x) : eval('0,' + x));
                        } else {
                          this_func(cb, 1);
                        }
                      } else
                        alert("error HTTP status " + x.status);
                    }
                    /*else
                    alert("currently the application is at" + invocation.readyState); */
                  };
                  if (addIMS)
                    x.setRequestHeader("if-modified-since", new Date(0));
                  //old Firefoxes send on XHR, new FF and new Chrome send */*
                  //Java EE server, if it sees "application/xml" it sends XML instead of JSON
                  //"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"
                  x.setRequestHeader("accept", "application/json");
                  x.send();
                  //code byte savings, reuse error var
                } catch (scriptElem) { /*no CORS (old Operas, IE6 either yes/no sec warn or just works)*/
                  /* alert("XHR failed-will try JSONP:\n"+e); */
                  /*  opera mobile 10.00, opera desktop 10.00 1750 need cache busting
                  raw button (forced download) doesnt work in updating cache */
                  window.j = function (r) {
                    cb(r.contents)
                  };
                  scriptElem = document.createElement("script");
                  scriptElem.src =
/*STARTDELETE*/
                    '//tinymta.us.to' +
/*ENDDELETE*/
                    '/api/wea?callback=j';
                  jsonp = document.getElementsByTagName('head')[0];
                  /*dont leak mem adding infinite JSONP script elements
                  this also cancels last in-progress, maybe timing out, JSONP fetch supposedly */
                  if (jsonp.childNodes.length > 1)
                    jsonp.removeChild(jsonp.childNodes[1]);
                  jsonp.appendChild(scriptElem);
                  /*document.body.appendChild(scriptElem);/*crashes on IE6 if forced JSONP mode*/
                }
              }
            };
          }
        });
      }
    }
  };
}

fetch('https://api.weather.com/v3/wx/forecast/hourly/1day?geocode=40.74,-73.91&format=json&units=e&language=en-US&apiKey=8de2d8b3a93542c9a2d8b3a935a2c909')
.then(function (r) {
r.json().then(function (r) {
  var frag = document.createDocumentFragment(),
  e, //elem
  v, //val
  l = r.qpf.length, //qpf shortest by chars token
  i = 0;
  for (; i < l; i++) {
    e = frag.appendChild(document.createElement('div'));
    e.className = 'h';
    v = +r.validTimeLocal[i].slice(11, 13);
    //perf, skip locale/Date objects
    e.appendChild(document.createTextNode((v % 12 || 12) + (v >= 12 ? 'PM\xa0' : 'AM\xa0')));
    e.appendChild(document.createElement('br'));
    e.appendChild(document.createTextNode(r.temperature[i] + "F"));
    e.appendChild(document.createElement('br'));
    e.appendChild(document.createTextNode(r.precipChance[i] + "%\ud83d\udca7"));
    e.appendChild(document.createElement('br'));
    v = e.appendChild(document.createElement('img'));
    v.src =
/*STARTINSERTPATH*/
    'w/'
/*ENDINSERTPATH*/
    +r.iconCode[i]+'.svg';
    v.className = 'i';
  }
  se.parentNode.replaceChild(frag, se);
  }
)});
</script>
<!-- parse after script tag, rendering is async b/c IO -->
<style>
.h{display:inline-block}
.i{height:2em}
</style>
<!-- spam trap -->
<br><br><br>
<a href="mailto:bulk88@tinymta.com"><font color="#fefefe">Contact us</font></a><br><a href="mailto:bulk88@tinymta.us.to"><font color="#fefefe">Contact us</font></a>
</body></html>
