<meta content=0 name=mobileoptimized><meta content=no-referrer name=referrer><link href=//otp-mta-prod.camsys-apps.com rel=dns-prefetch><link href=//otp-mta-prod.camsys-apps.com rel=preconnect><link href=//collector-otp-prod.camsys-apps.com rel=dns-prefetch><link href=//collector-otp-prod.camsys-apps.com rel=preconnect>No javascript<script defer src=https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.4/lodash.js></script><script>mangleIndex={name:"mangleIndex"},getStop.name="getStop",onJSP.name="onJSP";var x=this.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),jsonp,url,t=location.hash;function mkSubFontTag(t,e){e={1:"EE352E",2:"EE352E",3:"EE352E",4:"00933C",5:"00933C","5X":"00933C",6:"00933C","6X":"00A65C",7:"B933AD","7X":"B933AD",A:"2850AD",B:"FF6319",C:"2850AD",D:"FF6319",E:"2850AD",F:"FF6319",FX:"FF6319",G:"6CBE45",GS:"6D6E71",J:"996633",L:"A7A9AC",M:"FF6319",N:"FCCC0A",Q:"FCCC0A",R:"FCCC0A",W:"FCCC0A",Z:"996633"}[e||t];return e?"<font color="+e+">"+t+"</font>":t}function parseIsoDatetime(t,e){for(e in t=t.split(/[: T-]/))t[e]=parseFloat(t[e]);return"Min "+Math.floor(Math.abs((new Date(t[0],t[1]-1,t[2],t[3]||0,t[4]||0,t[5]||0,0)-new Date)/1e3)/60)}url="//otp-mta-prod.camsys-apps.com/otp/routers/default/index/routes?apikey=Z276E3rCeTzOQEoBPPN4JCEc6GfvdnYE",t="<a href=javascript:history.back()>Back</a> Refresh[<a href=javascript:getStop()>Fast</a> <a href=\"javascript:location.replace('"+(/status\.htm$/.test(location.pathname)?"status_.htm":"status.htm")+t+"')\">Slow</a>] <a href="+url+">Raw</a><br>",url?getStop():document.body.innerHTML="No station specified in url anchor.";const BANNED_XBUS_ROUTE_TYPE=702,NEW_HAVEN_BRANCHES=["MNR:4","MNR:5","MNR:6"],HARLEM_BRANCHES=["Wassaic"],WEIRD_RAIL_LINES=[{id:"MNR:Wassaic",agency:"MNR",color:"0039A6",inService:!0,mode:"RAIL",longName:"Wassaic",routeId:"MNR_Wassaic",routeType:2}],buildSubwayRoute=(mapper={},t=>{t=t.filter(t=>"SUBWAY"===t.mode.toUpperCase()).filter(t=>t.id.includes("MTA"));let a=[];return t.sort((t,e)=>t.shortName-e.shortName),t.forEach(t=>{let e;var r=t.shortName;(e="X"===r.substr(r.length-1,r.length)?_.find(a,{name:r.substr(0,r.indexOf("X"))}):e)?e.containsExpress=!0:a.push(e={agency:t.id.split(":")[0],agencyId:t.id.split(":")[0],name:t.id.split(":")[1],mode:"SUBWAY",color:t.color,sortOrder:t.sortOrder,id:t.id.split(":")[1]})}),a.sort((t,e)=>t.sortOrder-e.sortOrder),a}),buildBusRoute=t=>{return t.filter(t=>"BUS"===t.mode.toUpperCase()).filter(t=>t.id.includes("MTA")).map(t=>{var e="MTA New York City Transit"===t.agencyName?"MTA NYCT":"MTABC",r=e+"_"+t.id.split(":")[1];return{...t,agency:e,inService:!0,isExpressBus:t.routeType===BANNED_XBUS_ROUTE_TYPE,routeId:r,route:t.shortName}})},buildRailRoute=t=>{var e=t.filter(t=>"RAIL"===t.mode.toUpperCase()).filter(t=>t.id.includes("LI")||t.id.includes("MNR")).concat(WEIRD_RAIL_LINES).map(t=>{var e=t.id.includes("LI")?"LI":"MNR";return t.inService=!0,t.agency=e,t.agencyId=e,t.route=t.longName,t.routeId=t.routeId||t.id.replace(":","_"),t.mode="RAIL",t.shortName=t.longName,t}),r=(e.sort((t,e)=>t.longName<e.longName?-1:1),[]);if(Array.isArray(NEW_HAVEN_BRANCHES)&&Array.isArray(e)&&e.length)for(let t=0;t<e.length;t++)NEW_HAVEN_BRANCHES.includes(e[t].id)&&(r.push(e[t]),e.splice(t,1),t--);var t=_.findIndex(e,t=>"MNR:3"===t.id),a=[];if(Array.isArray(HARLEM_BRANCHES)&&Array.isArray(e)&&e.length)for(let t=0;t<e.length;t++)HARLEM_BRANCHES.includes(e[t].longName)&&(a.push(e[t]),e.splice(t,1),t--);var s=_.findIndex(e,t=>"MNR:2"===t.id),t=e.slice(0,t+1).concat(r).concat(e.slice(t+1));return t.slice(0,s+1).concat(a).concat(t.slice(s+1))},mergeStatii=(mapper.buildServiceRoutes=t=>{return{busRoutes:buildBusRoute(t),railLines:buildRailRoute(t),subwayLines:buildSubwayRoute(t),lastUpdated:new Date}},(t,e)=>{let r=[];let a=e.filter(a=>{let s=!1;try{if(a.alert.active_period&&a.alert["transit_realtime.mercury_alert"]&&a.alert["transit_realtime.mercury_alert"].alert_type){const i=a.alert["transit_realtime.mercury_alert"].hasOwnProperty("display_before_active");let r=Math.round(Date.now()/1e3);a.id.includes("planned_work")&&!i?s=!1:a.alert.active_period.forEach(e=>{if(e.start&&!s){let t=e.start;i&&(t-=a.alert["transit_realtime.mercury_alert"].display_before_active),r>t&&(s=!0),e.end&&r>e.end&&(s=!1)}})}}catch(t){console.log(t)}return s});return t.forEach(p=>{let t="SUBWAY"===p.mode?p.name:p.shortName,g=[],m=[],h=!0,y=[];"RAIL"===p.mode&&(t=p.routeId.includes("NJT")?p.routeId.replace("_",":"):p.routeId.split("_")[1]),t=(t="BUS"===p.mode?p.id.split(":")[1]:t).toLowerCase(),g.push(t),"BUS"===p.mode&&(g.push(t+"-ltd"),h=!1),a.forEach(c=>{c.alert&&c.alert.informed_entity&&c.alert.informed_entity.forEach(t=>{let e=null,r=null,a=1,s=!0;if(t.route_id&&(e=t.route_id),t.agency_id&&(r=t.agency_id),t.trip&&t.trip.route_id&&(e=t.trip.route_id,a=t.trip.direction_id),h&&(s=r==p.agency),e=e?e.toLowerCase():"",g.includes(e)&&s&&!y.includes(c.id))try{var i=(t=>{let e="No Status Summary";return e=t.alert["transit_realtime.mercury_alert"]?t.alert["transit_realtime.mercury_alert"].alert_type:e})(c),n=(t=>{let e=!1;if(t.alert.description_text){if(t.alert.description_text.translation.forEach(t=>{"en-html"===t.language&&(e=t.text)}),e)return e;if(e||t.alert.description_text.translation.forEach(t=>{"en"===t.language&&(e=t.text)}),e)return e;if(e||t.alert.description_text.translation.forEach(t=>{""===t.language&&(e=t.text)}),e);}return e})(c),o=(t=>{let e=!1;if(t.alert.header_text){if(t.alert.header_text.translation.forEach(t=>{"en-html"===t.language&&(e=t.text)}),e)return e;if(t.alert.header_text.translation.forEach(t=>{"en"===t.language&&(e=t.text)}),e)return e;if(t.alert.header_text.translation.forEach(t=>{""===t.language&&(e=t.text)}),e);}return e})(c),l=(t=>{let e=-10;return e=t["transit_realtime.mercury_entity_selector"]&&t["transit_realtime.mercury_entity_selector"].sort_order?(e=t["transit_realtime.mercury_entity_selector"].sort_order.split(":"))[2]?+e[2]:100:e})(t),u=(t=>{let a=null,s=null,e=null;if(t.alert.active_period){let e=Math.round(Date.now()/1e3),r=!1;t.alert.active_period.forEach(t=>{t.start&&(e>t.start&&(r=t),r=!(t.end&&e>t.end)&&r)}),a=r.start?new Date(1e3*r.start).toISOString():null,s=r.end?new Date(1e3*r.end).toISOString():null}return t.alert["transit_realtime.mercury_alert"]&&(e=new Date(1e3*t.alert["transit_realtime.mercury_alert"].created_at).toISOString()),{startDate:a,endDate:s,creationDate:e}})(c),d={id:c.id,statusSummary:i,statusDescription:n,statusTitle:o,priority:l,direction:a,originalStatus:c,...u};m.push(d),y.push(c.id)}catch(t){console.log(c.id,t)}})}),0<m.length&&(p.statusDetails=m),r.push(p)}),r});function groupedLines(){var e=[],t=[];for(let t=0;t<this.lines.length;t++){this.lines[t].statusDetails.sort((t,e)=>e.priority-t.priority);var r=this.toDashedCase(this.lines[t].statusDetails[0].statusSummary);e[r]||(e[r]={status:this.lines[t].statusDetails[0].statusSummary,priority:this.lines[t].statusDetails[0].priority}),e[r].lines||(e[r].lines=[]),e[r].lines.push(this.lines[t])}let a="";for(a in e)t.push(e[a]);return 0<t.length&&t.sort((t,e)=>e.priority-t.priority),t}const sortSubwayLines=t=>{t.sort((t,e)=>t.sortOrder-e.sortOrder)};function SET_SUBWAY_LINES(a,t){var e=t.subwayLines;a.lastUpdated=t.lastUpdated,a.subwayLines.length||a.goodServiceLines.length?_.each(e,t=>{var e=_.findIndex(a.goodServiceLines,{id:t.id}),r=_.findIndex(a.subwayLines,{id:t.id});-1<e?a.goodServiceLines.splice(e,1):-1<r&&a.subwayLines.splice(r,1),(t.statusDetails?a.subwayLines:a.goodServiceLines).push(t)}):(_.each(e,t=>{(t.statusDetails?a.subwayLines:a.goodServiceLines).push(t)}),t.subwayLines.length&&(a.allSubwayLines=t.subwayLines)),sortSubwayLines(a.subwayLines),sortSubwayLines(a.goodServiceLines)}function SET_BUS_ROUTES(r,t){t=t.busRoutes;let e=[];t.forEach(t=>{t.statusDetails&&(t.statusDetails.sort((t,e)=>e.priority-t.priority),e.push(t))}),r.alertedBuses=e,r.busRoutes.length?_.each(t,t=>{var e=_.find(r.busRoutes,{routeId:t.routeId});e&&(e.statusDetails=t.statusDetails)}):r.busRoutes=t}function SET_RAIL_LINES(r,t){t=t.railLines;t.forEach(t=>{t.statusDetails&&t.statusDetails.sort((t,e)=>e.priority-t.priority)}),r.mnrLines.length&&r.longIslandLines.length?_.each(t,t=>{var e;"LI"===t.agency?(e=_.find(r.longIslandLines,{routeId:t.routeId}))&&(e.statusDetails=t.statusDetails):"MNR"!==t.agency&&"NJT"!==t.agency||(e=_.find(r.mnrLines,{routeId:t.routeId}))&&(e.statusDetails=t.statusDetails)}):(r.longIslandLines=_.filter(t,{agency:"LI"}),r.mnrLines=_.filter(t,t=>"MNR"===t.agency||"NJT"===t.agency))}function toDashedCase(t){return t.toLowerCase().replace(/\s/g,"-")}function noPTag(t){return"string"==typeof t&&0===(t=t.replace(/(<p style="min-height:10px"><\/p>|<p><\/p>)+$/g,"")).indexOf("<p>")&&-1!==t.indexOf("</p>",t.length-4)?t.substring(3,t.length-4):t}function hasDuration(t){return t.originalStatus.alert["transit_realtime.mercury_alert"].human_readable_active_period}function getDurations(t){return t.originalStatus.alert["transit_realtime.mercury_alert"].human_readable_active_period.translation[0].text}function getStatus(t){return t.inService?t.statusDetails&&t.statusDetails.length?t.statusDetails[0].statusSummary:"On or Close":t.statusDetails&&t.statusDetails.length?t.statusDetails[0].statusSummary:"No Scheduled Service"}var get1=0,allRoutes;function genArvBodyObj(r){var h="",i,route,trip,alerts_headsign,o={},hotkey,hotkeys=[2,3,4,5,6,7,8,9,0],n;if(r=eval("0,"+r),get1){var statii=r.entity;const allStatii={busRoutes:mergeStatii(allRoutes.busRoutes,statii),railLines:mergeStatii(allRoutes.railLines,statii),subwayLines:mergeStatii(allRoutes.subwayLines,statii)};var state={mnrLines:[],busRoutes:[],subwayLines:[],componentRoutes:[],longIslandLines:[],goodServiceLines:[],favorites:null,lastUpdated:null,lineListError:null,allSubwayLines:null,subwayLineGroups:null,serviceStatusLoading:!1,alertedBuses:[]},groupedByStatusLines=(SET_SUBWAY_LINES(state,allStatii),SET_RAIL_LINES(state,allStatii),SET_BUS_ROUTES(state,allStatii),groupedLines.call({lines:state.subwayLines,toDashedCase:toDashedCase}));for(i in groupedByStatusLines){var linearr=groupedByStatusLines[i];for(o in h+="<hr>"+linearr.status+"<br>",linearr=linearr.lines,linearr)route=linearr[o],h+="<details><summary>"+mkSubFontTag("["+route.name+"]",route.name)+"</summary>",h+=route.statusDetails.map(function(t){return"<b>"+t.statusSummary+"</b><br>"+noPTag(t.statusTitle).replace(/\[(\w+)\]/g,mkSubFontTag)+(hasDuration(t)?"<br>"+getDurations(t):"")+"<br>"+(t.statusDescription?noPTag(t.statusDescription).replace(/\[(\w+)\]/g,mkSubFontTag):"")}).join("<hr>"),h+="</details>"}if(groupedByStatusLines=state.goodServiceLines,groupedByStatusLines.length)for(o in h+="<hr>No Active Alerts<br>",groupedByStatusLines)route=groupedByStatusLines[o].name,h+=mkSubFontTag("["+route+"]",route)+" ";state.mnrLines.length&&(h+="<hr>Metro-North Railroad<br>",h+=state.mnrLines.map(function(t){var e=t.statusDetails&&t.statusDetails.length;return"<hr>"+(e?"<details><summary>":"")+"<font color="+t.color+">"+t.route+"</font> "+getStatus(t)+(e?"</summary>"+t.statusDetails.map(function(t){return"<b>"+t.statusSummary+"</b><br>"+noPTag(t.statusTitle).replace(/\[(\w+)\]/g,mkSubFontTag)+(hasDuration(t)?"<br>"+getDurations(t):"")+"<br>"+(t.statusDescription?noPTag(t.statusDescription).replace(/\[(\w+)\]/g,mkSubFontTag):"")}).join("<hr>")+"</details>":"")}).join(""))}else r=mapper.buildServiceRoutes(r),allRoutes=r,url="//collector-otp-prod.camsys-apps.com/realtime/gtfsrt/ALL/alerts?type=json&apikey=qeqy84JE7hUKfaI0Lxm2Ttcm6ZA0bYrP",get1=1,getStop();document.body.innerHTML+=h}function getStop(e){document.body.innerHTML=t;try{x.open("get",url,1),x.onreadystatechange=function(){4==x.readyState&&(200==x.status?"withCredentials"in x||x.getResponseHeader("Date")?genArvBodyObj(x.responseText):getStop(1):alert("error HTTP status "+x.status))},e&&x.setRequestHeader("if-MODIFIED-since",new Date(0)),x.setRequestHeader("accept","application/json"),x.send()}catch(t){(t=document.createElement("script")).src="//api.allorigins.win/get?url=http%3A"+escape(url+"&_=")+(new Date).getTime()+"&callback=onJSP",1<(jsonp=document.getElementsByTagName("head")[0]).childNodes.length&&jsonp.removeChild(jsonp.childNodes[1]),jsonp.appendChild(t)}}function onJSP(t){genArvBodyObj(t.contents)}</script>