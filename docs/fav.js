!function(){function i(){try{var e=localStorage.getItem("fav");return e&&0==e.indexOf(t+"[0,")?[0,JSON.parse(e.slice(t.length,e.length-1))]:(localStorage.setItem("fav",t+"[0,1,0])"),[1,[0,1,0]])}catch(e){return 0}}function d(e){return localStorage.setItem("fav",t+JSON.stringify(e)+")"),e}function c(e){(e=e.firstChild).nextSibling.firstChild.onchange=e.firstChild.onchange=function(e){var t=i()[1],n=(e=e.target).checked;(e=e.parentNode).lastChild.color?n?t[1]=1:(t[1]=0,t.length=3):t[2]=n?t[1]=1:0,(e=e.parentNode).draw_fav(d(t),e.draw_fav,e,c)}}function e(e,t){var n,a,c,o=i(),r=3;if(o&&(o=o[1])[1]){for(c=o.length;r<c;r++)if((f=o[r])[1]==t){f[2]++,3<r&&f[2]>(a=o[r-1])[2]&&(o[r-1]=f,o[r]=a),n=1;break}n||(o[9==c?8:c]=[e,t,1]),d(o)}}var o='function(e,t,a,n,c){function o(e,f){"r"==e.charAt()?(e=e.slice(1),fetch("//backend-unified.mylirr.org/arrivals/"+e,{headers:{"accept-version":"3.0"}}).then(function(e){200==e.status&&e.json().then(function(e){var t,a,n,c=[],o=[];for(e=e.arrivals,a=0;a<e.length&&a<4;a++)t=e[a],n=new Date(1e3*(n=t.time)).toLocaleTimeString().replace(/:00 ([PA])M/,"$1")+" "+Math.ceil((n-(new Date).getTime()/1e3)/60)+"m"+((n=(n=t.status.otp)&&n/60|0)?0<n?"-E"+n:"-L"+-n:"")+"-Tk"+(t.track||"?")+"-<font color="+{HA:"0039a6",HH:"006ec7",PJ:"006ec7",BY:"00985f",HU:"009b3a",WH:"00a1de",OB:"00af3f",MK:"00b2a9",12:"4d5357",CI:"4d5357",11:"60269e",FR:"6e3219",RK:"a626aa",PW:"c60c30",HM:"ce8e00",DN:"ee0034",NC:"ee0034",NH:"ee0034",WB:"ee0034",LB:"ff6319"}[t.branch]+">"+("HM"==(n=(n=(n=t.stops)[n.length-1]).charAt()<58?n.slice(1):n)?"CH":"NYK"==n?"NYP":n)+"</font>",("E"==t.direction?o:c).push(n);f.innerHTML=o.concat(c).join(",")+"&nbsp;"})})):(e=e.slice(1,4),fetch("//otp-mta-prod.camsys-apps.com/otp/routers/default/nearby?timerange=1800&apikey=Z276E3rCeTzOQEoBPPN4JCEc6GfvdnYE&stops=MTASBWY:"+e).then(function(e){200==e.status&&e.json().then(function(e){var t,a,n,c,o,r,d,i=0,p={};if(e=e[0]){for(;n=e.groups[i++];)for(o=n.headsign,a=0;c=n.times[a++];)c.shortRouteName=n.route.shortName,c.timestamp>t&&(t=c.timestamp),(p[o]=p[o]||[]).push(c);for(i in p)p[i].sort(function(e,t){return e.departureFmt<t.departureFmt?-1:e.departureFmt>t.departureFmt?1:0});for(i in t=[],p)for(n=p[i],i=0;(c=n[i++])&&i<4;)t.push(("1"==c.directionId?"S":"N")+(r=c.shortRouteName,d=void 0,(d={4:"00933c",5:"00933c","5X":"00933c",6:"00933c","6X":"00a65c",A:"2850ad",C:"2850ad",E:"2850ad",G:"6cbe45",GS:"6d6e71",J:"996633",Z:"996633",L:"a7a9ac",7:"b933ad","7X":"b933ad",1:"ee352e",2:"ee352e",3:"ee352e",N:"fccc0a",Q:"fccc0a",R:"fccc0a",W:"fccc0a",B:"ff6319",D:"ff6319",F:"ff6319",FX:"ff6319",M:"ff6319"}[r])?"<font color="+d+">"+r+"</font>":r)+function(e,t){for(e=e.split(/[: T-]/),t=0;t<e.length;t++)e[t]=+e[t];return"-"+(0|Math.abs((new Date(e[0],e[1]-1,e[2],e[3]||0,e[4]||0,e[5]||0,0)-new Date)/1e3)/60)}(c.departureFmt))}f.innerHTML=t.join(",")+"&nbsp;"})}))}function r(e,t){setTimeout(function(){o(e,t)},0)}var d,p=document.createElement("div"),f=p.appendChild(document.createElement("label"));if((d=f.appendChild(document.createElement("input"))).type="checkbox",d.checked=e[1],(v=f.appendChild(document.createElement("font"))).color="red",v.appendChild(document.createTextNode("❤")),(d=(f=p.appendChild(document.createElement("label"))).appendChild(document.createElement("input"))).type="checkbox",d.checked=e[1]&&e[2],f.appendChild(document.createTextNode("⌛ ")),f=e[1]?3==e.length?"No history yet":0:"History off")p.appendChild(document.createTextNode(f));else for(i=3;i<9&&(f=e[i]);i++)(d=p.appendChild(document.createElement("a"))).href=("r"==f[1].charAt()?"rstop.htm#":"stop.htm#")+f[1].slice(1),d.appendChild(document.createTextNode(f[0])),p.appendChild(document.createTextNode(" ")),e[2]&&((d=p.appendChild(document.createElement("span"))).style.display="inline",(c?r:o)(f[1],d));(window.favDiv=p).draw_fav=t,a?(a.parentNode.replaceChild(p,a),n(p)):document.body.appendChild(p)}',t="(function(c){var f="+o+";f(c,f)})(",n,f;if(n=this.rF)for(f=0;f<n.length;f+=2)e(n[f],n[f+1]);this.rF={push:e};var a=location.pathname,r;"/"!=a.slice(-1)&&a.indexOf("/index")||(n=document.documentElement.firstChild,a=document.createElement("link"),a.rel="preload",a.as="script",a.href="routes.js",n.appendChild(a),a=document.createElement("link"),a.rel="prefetch",a.href="stop.htm",a=n.appendChild(a).cloneNode(0),a.href="rstop.htm",n.appendChild(a),window.onpageshow=function(e){e.persisted&&(e=this.favDiv)&&e.draw_fav(i()[1],e.draw_fav,e,c,1)},r=function(){var e=i(),t=this.favDiv,n,a;if(e)if(e[0])if(n=eval("("+o+")"),t)n(e[1],n,t,c);else{for(a=document.body.lastChild;a&&"STYLE"!=a.nodeName;)a=a.previousElementSibling;a&&n(e[1],n,a.parentNode.insertBefore(document.createElement("div"),a),c)}else t?c(t):alert("no div but saw fav draw code")},document.body?r():this.x=r)}();