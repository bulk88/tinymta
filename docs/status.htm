<link href=//otp-mta-prod.camsys-apps.com rel=dns-prefetch><link href=//otp-mta-prod.camsys-apps.com rel=preconnect><link href=//collector-otp-prod.camsys-apps.com rel=dns-prefetch><link href=//collector-otp-prod.camsys-apps.com rel=preconnect><meta content=0 name=mobileoptimized><meta content=no-referrer name=referrer>No javascript<script>var u,t="//otp-mta-prod.camsys-apps.com/otp/routers/default/index/routes?apikey=Z276E3rCeTzOQEoBPPN4JCEc6GfvdnYE",e="//collector-otp-prod.camsys-apps.com/realtime/gtfsrt/ALL/alerts?type=json&apikey=qeqy84JE7hUKfaI0Lxm2Ttcm6ZA0bYrP",r="<a href=javascript:history.back()>Back</a> Refresh[<a href=javascript:n()>Fast</a> <a href=\"javascript:location.replace('stop_.htm')\">Slow</a>] <a href="+t+">RawR</a> <a href="+e+">RawA</a><br>",l,c;function n(){I(t),I(e,1),document.body.innerHTML=r}function f(t,e){e={1:"EE352E",2:"EE352E",3:"EE352E",4:"00933C",5:"00933C","5X":"00933C",6:"00933C","6X":"00A65C",7:"B933AD","7X":"B933AD",A:"2850AD",B:"FF6319",C:"2850AD",D:"FF6319",E:"2850AD",F:"FF6319",FX:"FF6319",G:"6CBE45",GS:"6D6E71",J:"996633",L:"A7A9AC",M:"FF6319",N:"FCCC0A",Q:"FCCC0A",R:"FCCC0A",W:"FCCC0A",Z:"996633"}[e||t];return e?"<font color="+e+">"+t+"</font>":t}function i(t){var t=t.filter(function(t){return"SUBWAY"==t.mode.toUpperCase()}).filter(function(t){return t.id.includes("MTA")}),n=[];return t.sort(function(t,e){return isNaN(t.shortName)||isNaN(e.shortName)?0:t.shortName-e.shortName}),t.forEach(function(t){var e,r=t.shortName;(e="X"==r.substr(r.length-1,r.length)?_.find(n,{name:r.substr(0,r.indexOf("X"))}):e)?e.containsExpress=!0:n.push(e={agency:t.id.split(":")[0],agencyId:t.id.split(":")[0],name:t.id.split(":")[1],mode:"SUBWAY",color:t.color,sortOrder:t.sortOrder,id:t.id.split(":")[1]})}),n.sort(function(t,e){return t.sortOrder-e.sortOrder}),n}function a(t){return t.filter(function(t){return"BUS"==t.mode.toUpperCase()}).filter(function(t){return!!~t.id.indexOf("MTA")}).map(function(t){var e="MTA New York City Transit"===t.agencyName?"MTA NYCT":"MTABC",r=e+"_"+t.id.split(":")[1];return Object.assign({agency:e,inService:!0,isExpressBus:702===t.routeType,routeId:r,route:t.shortName},t)})}function s(t){var e=t.filter(function(t){return"RAIL"==t.mode.toUpperCase()}).filter(function(t){return t.id.includes("LI")||t.id.includes("MNR")}).concat([{id:"MNR:Wassaic",agency:"MNR",color:"0039A6",inService:!0,mode:"RAIL",longName:"Wassaic",routeId:"MNR_Wassaic",routeType:2}]).map(function(t){var e=t.id.includes("LI")?"LI":"MNR";return t.inService=!0,t.agency=e,t.agencyId=e,t.route=t.longName,t.routeId=t.routeId||t.id.replace(":","_"),t.mode="RAIL",t.shortName=t.longName,t}),r=(e.sort(function(t,e){return t.longName<e.longName?-1:1}),[]);if(e instanceof Array&&e.length)for(var n=0;n<e.length;n++)["MNR:4","MNR:5","MNR:6"].includes(e[n].id)&&(r.push(e[n]),e.splice(n,1),n--);var t=_.findIndex(e,function(t){return"MNR:3"===t.id}),i=[];if(e instanceof Array&&e.length)for(n=0;n<e.length;n++)["Wassaic"].includes(e[n].longName)&&(i.push(e[n]),e.splice(n,1),n--);var a=_.findIndex(e,function(t){return"MNR:2"===t.id}),t=e.slice(0,t+1).concat(r).concat(e.slice(t+1));return t.slice(0,a+1).concat(i).concat(t.slice(a+1))}function d(t,e){var r=[];var n=e.filter(function(r){var n,i,a=!1;try{r.alert.active_period&&r.alert["transit_realtime.mercury_alert"]&&r.alert["transit_realtime.mercury_alert"].alert_type&&(n=r.alert["transit_realtime.mercury_alert"].hasOwnProperty("display_before_active"),i=Math.round(Date.now()/1e3),r.id.includes("planned_work")&&!n?a=!1:r.alert.active_period.forEach(function(t){var e;t.start&&!a&&(e=t.start,n&&(e-=r.alert["transit_realtime.mercury_alert"].display_before_active),e<i&&(a=!0),t.end&&i>t.end&&(a=!1))}))}catch(t){console.log(t)}return a});return t.forEach(function(D){var t="SUBWAY"===D.mode?D.name:D.shortName,A=[],E=[],N=!0,I=[];"RAIL"===D.mode&&(t=D.routeId.includes("NJT")?D.routeId.replace("_",":"):D.routeId.split("_")[1]),t=(t="BUS"===D.mode?D.id.split(":")[1]:t).toLowerCase(),A.push(t),"BUS"===D.mode&&(A.push(t+"-ltd"),N=!1),n.forEach(function(L){L.alert&&L.alert.informed_entity&&L.alert.informed_entity.forEach(function(t){var e,r,n,i,a,s,o,u,l,c,f=null,d=null,p=1,h=!0;if(t.route_id&&(f=t.route_id),t.agency_id&&(d=t.agency_id),t.trip&&t.trip.route_id&&(f=t.trip.route_id,p=t.trip.direction_id),N&&(h=d==D.agency),f=f?f.toLowerCase():"",A.includes(f)&&h&&!I.includes(L.id))try{c="No Status Summary";var m=c=(l=L).alert["transit_realtime.mercury_alert"]?l.alert["transit_realtime.mercury_alert"].alert_type:c,g=function(t){var e=!1;if(t.alert.description_text){if(t.alert.description_text.translation.forEach(function(t){"en-html"===t.language&&(e=t.text)}),e)return e;if(e||t.alert.description_text.translation.forEach(function(t){"en"===t.language&&(e=t.text)}),e)return e;if(e||t.alert.description_text.translation.forEach(function(t){""===t.language&&(e=t.text)}),e);}return e}(L),_=function(t){var e=!1;if(t.alert.header_text){if(t.alert.header_text.translation.forEach(function(t){"en-html"===t.language&&(e=t.text)}),e)return e;if(t.alert.header_text.translation.forEach(function(t){"en"===t.language&&(e=t.text)}),e)return e;if(t.alert.header_text.translation.forEach(function(t){""===t.language&&(e=t.text)}),e);}return e}(L),b=(u=-10,u=(o=t)["transit_realtime.mercury_entity_selector"]&&o["transit_realtime.mercury_entity_selector"].sort_order?(u=o["transit_realtime.mercury_entity_selector"].sort_order.split(":"))[2]?+u[2]:100:u),v=(s=a=i=null,(e=L).alert.active_period&&(r=Math.round(Date.now()/1e3),n=!1,e.alert.active_period.forEach(function(t){t.start&&(r>t.start&&(n=t),t.end&&r>t.end&&(n=!1))}),i=n.start?new Date(1e3*n.start).toISOString():null,a=n.end?new Date(1e3*n.end).toISOString():null),{startDate:i,endDate:a,creationDate:s=e.alert["transit_realtime.mercury_alert"]?new Date(1e3*e.alert["transit_realtime.mercury_alert"].created_at).toISOString():s}),w=Object.assign({id:L.id,statusSummary:m,statusDescription:g,statusTitle:_,priority:b,direction:p,originalStatus:L},v);E.push(w),I.push(L.id)}catch(S){console.log(L.id,S)}})}),0<E.length&&(D.statusDetails=E),r.push(D)}),r}function p(){for(var t={},e=[],r=0;r<this.lines.length;r++){this.lines[r].statusDetails.sort(function(t,e){return e.priority-t.priority});var n=this.toDashedCase(this.lines[r].statusDetails[0].statusSummary);t[n]||(t[n]={status:this.lines[r].statusDetails[0].statusSummary,priority:this.lines[r].statusDetails[0].priority}),t[n].lines||(t[n].lines=[]),t[n].lines.push(this.lines[r])}var i="";for(i in t)e.push(t[i]);return 0<e.length&&e.sort(function(t,e){return e.priority-t.priority}),e}function o(t){t.sort(function(t,e){return t.sortOrder-e.sortOrder})}function h(n,t){var e=t.subwayLines;n.lastUpdated=t.lastUpdated,n.subwayLines.length||n.goodServiceLines.length?_.each(e,function(t){var e=_.findIndex(n.goodServiceLines,{id:t.id}),r=_.findIndex(n.subwayLines,{id:t.id});-1<e?n.goodServiceLines.splice(e,1):-1<r&&n.subwayLines.splice(r,1),(t.statusDetails?n.subwayLines:n.goodServiceLines).push(t)}):(_.each(e,function(t){(t.statusDetails?n.subwayLines:n.goodServiceLines).push(t)}),t.subwayLines.length&&(n.allSubwayLines=t.subwayLines)),o(n.subwayLines),o(n.goodServiceLines)}function m(r,t){var t=t.busRoutes,e=[];t.forEach(function(t){t.statusDetails&&(t.statusDetails.sort(function(t,e){return e.priority-t.priority}),e.push(t))}),r.alertedBuses=e,r.busRoutes.length?_.each(t,function(t){var e=_.find(r.busRoutes,{routeId:t.routeId});e&&(e.statusDetails=t.statusDetails)}):r.busRoutes=t}function g(r,t){t=t.railLines;t.forEach(function(t){t.statusDetails&&t.statusDetails.sort(function(t,e){return e.priority-t.priority})}),r.mnrLines.length&&r.longIslandLines.length?_.each(t,function(t){var e;"LI"===t.agency?(e=_.find(r.longIslandLines,{routeId:t.routeId}))&&(e.statusDetails=t.statusDetails):"MNR"!==t.agency&&"NJT"!==t.agency||(e=_.find(r.mnrLines,{routeId:t.routeId}))&&(e.statusDetails=t.statusDetails)}):(r.longIslandLines=_.filter(t,{agency:"LI"}),r.mnrLines=_.filter(t,function(t){return"MNR"===t.agency||"NJT"===t.agency}))}function b(t){return t.toLowerCase().replace(/\s/g,"-")}function v(t){return"string"==typeof t&&!(t=t.replace(/(<p style="min-height:10px"><\/p>|<p><\/p>)+$/g,"")).indexOf("<p>")&&~t.indexOf("</p>",t.length-4)?t.substring(3,t.length-4):t}function w(t){return t.originalStatus.alert["transit_realtime.mercury_alert"].human_readable_active_period}function S(t){return t.originalStatus.alert["transit_realtime.mercury_alert"].human_readable_active_period.translation[0].text}function L(t){return t.inService?t.statusDetails&&t.statusDetails.length?t.statusDetails[0].statusSummary:"On or Close":t.statusDetails&&t.statusDetails.length?t.statusDetails[0].statusSummary:"No Scheduled Service"}function D(t,e){var r="";return r=e.length?(r+="<hr>"+t+"<br>")+e.map(function(t){var e=t.statusDetails&&t.statusDetails.length;return"<hr>"+(e?"<details><summary>":"")+"<font color="+t.color+">"+t.route+"</font> "+L(t)+(e?"</summary>"+t.statusDetails.map(function(t){return"<b>"+t.statusSummary+"</b><br>"+v(t.statusTitle)+(w(t)?"<br>"+S(t):"")+"<br>"+(t.statusDescription?v(t.statusDescription):"")}).join("<hr>")+"</details>":"")}).join(""):r}function A(t){l=mapper.buildServiceRoutes("object"==typeof t?t:this.JSON?JSON.parse(t):eval("0,"+t)),c&&N()}function E(t){c=("object"==typeof t?t:this.JSON?JSON.parse(t):eval("0,"+t)).entity,l&&N()}function N(){for(var t,e,r=(new Date).toLocaleTimeString("en-US")+(u?" via JSONP":" via CORS")+"<br>",n=c,n={busRoutes:d(l.busRoutes,n),railLines:d(l.railLines,n),subwayLines:d(l.subwayLines,n)},i={mnrLines:[],busRoutes:[],subwayLines:[],componentRoutes:[],longIslandLines:[],goodServiceLines:[],favorites:null,lastUpdated:null,lineListError:null,allSubwayLines:null,subwayLineGroups:null,serviceStatusLoading:!1,alertedBuses:[]},a=(h(i,n),g(i,n),m(i,n),p.call({lines:i.subwayLines,toDashedCase:b})),s=0;s<a.length;s++){var o=a[s];for(r+="<hr>"+o.status+"<br>",o=o.lines,e=0;e<o.length;e++)r=(r+="<details><summary>"+f("["+(t=o[e]).name+"]",t.name)+"</summary>")+t.statusDetails.map(function(t){return"<b>"+t.statusSummary+"</b><br>"+v(t.statusTitle).replace(/\[(\w+)\]/g,f)+(w(t)?"<br>"+S(t):"")+"<br>"+(t.statusDescription?v(t.statusDescription).replace(/\[(\w+)\]/g,f):"")}).join("<hr>")+"</details>"}if((a=i.goodServiceLines).length)for(r+="<hr>No Active Alerts<br>",s=0;s<a.length;s++)r+=f("["+(t=a[s].name)+"]",t)+" ";r=(r+=D("Metro-North Railroad",i.mnrLines))+D("Long Island Rail Road",i.longIslandLines),document.body.innerHTML+=r,l=c=void 0}function I(t,e,r){var x=this.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");try{if(u)throw 0;x.open("get",t,1);try{x.responseType="json"}catch(n){}x.onreadystatechange=function(){4==x.readyState&&(200==x.status?"withCredentials"in x||x.getResponseHeader("Date")?(e?E:A)(x.response):I(t,e,1):alert("error HTTP status "+x.status))},r&&x.setRequestHeader("if-MODIFIED-since",new Date(0)),x.setRequestHeader("accept","application/json"),x.send()}catch(i){(i=document.createElement("script")).src="//api.allorigins.win/get?url=http%3A"+escape(t+"&_=")+(new Date).getTime()+"&callback="+(e?"R":"O"),1<(u=document.getElementsByTagName("head")[0]).childNodes.length&&u.removeChild(u.childNodes[1]),u.appendChild(i)}}function O(t){A(t.contents)}function R(t){E(t.contents)}n(),"function"!=typeof Object.assign&&(Object.assign=function(t,e){"use strict";if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(t),n=1;n<arguments.length;n++){var i=arguments[n];if(null!=i)for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(r[a]=i[a])}return r}),String.prototype.includes||(String.prototype.includes=function(t,e){"use strict";return!((e="number"!=typeof e?0:e)+t.length>this.length)&&!!~this.indexOf(t,e)}),Array.prototype.includes||(Array.prototype.includes=function(e){return 0<this.filter(function(t){return t==e}).length}),Object.keys||(Object.keys=function(t){if(t!==Object(t))throw new TypeError("Object.keys called on a non-object");var e,r=[];for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&r.push(e);return r}),Array.prototype.findIndex||(Array.prototype.findIndex=function(t){if(null===this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof t)throw new TypeError("callback must be a function");for(var e=Object(this),r=e.length>>>0,n=arguments[1],i=0;i<r;i++)if(t.call(n,e[i],i,e))return i;return-1}),Array.prototype.find||(Array.prototype.find=function(t){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof t)throw new TypeError("callback must be a function");for(var e=Object(this),r=e.length>>>0,n=arguments[1],i=0;i<r;i++){var a=e[i];if(t.call(n,a,i,e))return a}}),Array.prototype.filter||(Array.prototype.filter=function(t){"use strict";if(null==this)throw new TypeError;var e,r,n,i,a=Object(this),s=a.length>>>0;if("function"!=typeof t)throw new TypeError;for(e=[],r=arguments[1],n=0;n<s;n++)n in a&&(i=a[n],t.call(r,i,n,a)&&e.push(i));return e}),Array.prototype.map||(Array.prototype.map=function(t,e){var r,n,i;if(null==this)throw new TypeError(" this is null or not defined");var a,s=Object(this),o=s.length>>>0;if("function"!=typeof t)throw new TypeError(t+" is not a function");for(e&&(r=e),n=Array(o),i=0;i<o;)i in s&&(a=s[i],a=t.call(r,a,i,s),n[i]=a),i++;return n}),Array.prototype.forEach||(Array.prototype.forEach=function(t,e){"use strict";for(var r=0,n=this.length;r<n;++r)r in this&&t.call(e,this[r],r,this)}),Date.now||(Date.now=function C(){return(new Date).getTime()}),Date.prototype.toISOString||(Date.prototype.toISOString=function(){var t=1+this.getMonth(),e=this.getDay();return this.getFullYear()+"-"+(t<10?"0"+t:t)+"-"+(e<10?"0"+e:e)}),_={findIndex:function(t,e){return t.findIndex(e)},find:function(t,e){var r=Object.keys(e)[0],n=e[r];return t.find(function(t){return"object"==typeof t&&t[r]==n?1:0})},each:function(t,e){t.forEach(e)},filter:function(t,e){var r,n;return"function"==typeof e?t.filter(e):(r=Object.keys(e)[0],n=e[r],t.filter(function(t){return"object"==typeof t&&t[r]==n?1:0}))}},mapper={buildServiceRoutes:function(t){return{busRoutes:a(t),railLines:s(t),subwayLines:i(t),lastUpdated:new Date}}}</script>