<link href=//otp-mta-prod.camsys-apps.com rel=dns-prefetch><link href=//otp-mta-prod.camsys-apps.com rel=preconnect><link href=//collector-otp-prod.camsys-apps.com rel=dns-prefetch><link href=//collector-otp-prod.camsys-apps.com rel=preconnect><meta content=0 name=mobileoptimized><meta content=no-referrer name=referrer>No javascript<script src=https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.4/lodash.min.js></script><script>var i,t="//otp-mta-prod.camsys-apps.com/otp/routers/default/index/routes?apikey=Z276E3rCeTzOQEoBPPN4JCEc6GfvdnYE",e="//collector-otp-prod.camsys-apps.com/realtime/gtfsrt/ALL/alerts?type=json&apikey=qeqy84JE7hUKfaI0Lxm2Ttcm6ZA0bYrP",r="<a href=javascript:history.back()>Back</a> Refresh[<a href=javascript:n()>Fast</a> <a href=\"javascript:location.replace('status.htm')\">Slow</a>] <a href="+t+">RawR</a> <a href="+e+">RawA</a><br>";function n(){document.body.innerHTML=r,T(t),T(e,1)}function u(t,e){e={1:"EE352E",2:"EE352E",3:"EE352E",4:"00933C",5:"00933C","5X":"00933C",6:"00933C","6X":"00A65C",7:"B933AD","7X":"B933AD",A:"2850AD",B:"FF6319",C:"2850AD",D:"FF6319",E:"2850AD",F:"FF6319",FX:"FF6319",G:"6CBE45",GS:"6D6E71",J:"996633",L:"A7A9AC",M:"FF6319",N:"FCCC0A",Q:"FCCC0A",R:"FCCC0A",W:"FCCC0A",Z:"996633"}[e||t];return e?"<font color="+e+">"+t+"</font>":t}n(),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function B(t,e){"use strict";if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(t),n=1;n<arguments.length;n++){var i=arguments[n];if(null!=i)for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(r[a]=i[a])}return r},writable:!0,configurable:!0}),String.prototype.includes||(String.prototype.includes=function(t,e){"use strict";return!((e="number"!=typeof e?0:e)+t.length>this.length)&&!!~this.indexOf(t,e)}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{enumerable:!1,value:function(e){return 0<this.filter(function(t){return t==e}).length}});const a=702,s=["MNR:4","MNR:5","MNR:6"],o=["Wassaic"],l=[{id:"MNR:Wassaic",agency:"MNR",color:"0039A6",inService:!0,mode:"RAIL",longName:"Wassaic",routeId:"MNR_Wassaic",routeType:2}],c=(mapper={},function(t){t=t.filter(function(t){return"SUBWAY"==t.mode.toUpperCase()}).filter(function(t){return t.id.includes("MTA")});let n=[];return t.sort(function(t,e){return t.shortName-e.shortName}),t.forEach(function(t){let e;var r=t.shortName;(e="X"==r.substr(r.length-1,r.length)?_.find(n,{name:r.substr(0,r.indexOf("X"))}):e)?e.containsExpress=!0:n.push(e={agency:t.id.split(":")[0],agencyId:t.id.split(":")[0],name:t.id.split(":")[1],mode:"SUBWAY",color:t.color,sortOrder:t.sortOrder,id:t.id.split(":")[1]})}),n.sort(function(t,e){return t.sortOrder-e.sortOrder}),n}),d=function(t){return t.filter(function(t){return"BUS"==t.mode.toUpperCase()}).filter(function(t){return!!~t.id.indexOf("MTA")}).map(function(t){var e="MTA New York City Transit"===t.agencyName?"MTA NYCT":"MTABC",r=e+"_"+t.id.split(":")[1];return Object.assign({agency:e,inService:!0,isExpressBus:t.routeType===a,routeId:r,route:t.shortName},t)})},f=function(t){var e=t.filter(function(t){return"RAIL"==t.mode.toUpperCase()}).filter(function(t){return t.id.includes("LI")||t.id.includes("MNR")}).concat(l).map(function(t){var e=t.id.includes("LI")?"LI":"MNR";return t.inService=!0,t.agency=e,t.agencyId=e,t.route=t.longName,t.routeId=t.routeId||t.id.replace(":","_"),t.mode="RAIL",t.shortName=t.longName,t}),r=(e.sort(function(t,e){return t.longName<e.longName?-1:1}),[]);if(Array.isArray(s)&&Array.isArray(e)&&e.length)for(let t=0;t<e.length;t++)s.includes(e[t].id)&&(r.push(e[t]),e.splice(t,1),t--);var t=_.findIndex(e,function(t){return"MNR:3"===t.id}),n=[];if(Array.isArray(o)&&Array.isArray(e)&&e.length)for(let t=0;t<e.length;t++)o.includes(e[t].longName)&&(n.push(e[t]),e.splice(t,1),t--);var i=_.findIndex(e,function(t){return"MNR:2"===t.id}),t=e.slice(0,t+1).concat(r).concat(e.slice(t+1));return t.slice(0,i+1).concat(n).concat(t.slice(i+1))},p=(mapper.buildServiceRoutes=function(t){return{busRoutes:d(t),railLines:f(t),subwayLines:c(t),lastUpdated:new Date}},function(t,e){let r=[];let n=e.filter(function(n){let i=!1;try{if(n.alert.active_period&&n.alert["transit_realtime.mercury_alert"]&&n.alert["transit_realtime.mercury_alert"].alert_type){const a=n.alert["transit_realtime.mercury_alert"].hasOwnProperty("display_before_active");let r=Math.round(Date.now()/1e3);n.id.includes("planned_work")&&!a?i=!1:n.alert.active_period.forEach(function(e){if(e.start&&!i){let t=e.start;a&&(t-=n.alert["transit_realtime.mercury_alert"].display_before_active),r>t&&(i=!0),e.end&&r>e.end&&(i=!1)}})}}catch(t){console.log(t)}return i});return t.forEach(function(p){let t="SUBWAY"===p.mode?p.name:p.shortName,m=[],h=[],g=!0,_=[];"RAIL"===p.mode&&(t=p.routeId.includes("NJT")?p.routeId.replace("_",":"):p.routeId.split("_")[1]),t=(t="BUS"===p.mode?p.id.split(":")[1]:t).toLowerCase(),m.push(t),"BUS"===p.mode&&(m.push(t+"-ltd"),g=!1),n.forEach(function(f){f.alert&&f.alert.informed_entity&&f.alert.informed_entity.forEach(function(t){let e=null,r=null,n=1,i=!0;if(t.route_id&&(e=t.route_id),t.agency_id&&(r=t.agency_id),t.trip&&t.trip.route_id&&(e=t.trip.route_id,n=t.trip.direction_id),g&&(i=r==p.agency),e=e?e.toLowerCase():"",m.includes(e)&&i&&!_.includes(f.id))try{var a=function(t){let e="No Status Summary";return e=t.alert["transit_realtime.mercury_alert"]?t.alert["transit_realtime.mercury_alert"].alert_type:e}(f),s=function(t){let e=!1;if(t.alert.description_text){if(t.alert.description_text.translation.forEach(function(t){"en-html"===t.language&&(e=t.text)}),e)return e;if(e||t.alert.description_text.translation.forEach(function(t){"en"===t.language&&(e=t.text)}),e)return e;if(e||t.alert.description_text.translation.forEach(function(t){""===t.language&&(e=t.text)}),e);}return e}(f),o=function(t){let e=!1;if(t.alert.header_text){if(t.alert.header_text.translation.forEach(function(t){"en-html"===t.language&&(e=t.text)}),e)return e;if(t.alert.header_text.translation.forEach(function(t){"en"===t.language&&(e=t.text)}),e)return e;if(t.alert.header_text.translation.forEach(function(t){""===t.language&&(e=t.text)}),e);}return e}(f),u=function(t){let e=-10;return e=t["transit_realtime.mercury_entity_selector"]&&t["transit_realtime.mercury_entity_selector"].sort_order?(e=t["transit_realtime.mercury_entity_selector"].sort_order.split(":"))[2]?+e[2]:100:e}(t),l=function(t){let n=null,i=null,e=null;if(t.alert.active_period){let e=Math.round(Date.now()/1e3),r=!1;t.alert.active_period.forEach(function(t){t.start&&(e>t.start&&(r=t),r=!(t.end&&e>t.end)&&r)}),n=r.start?new Date(1e3*r.start).toISOString():null,i=r.end?new Date(1e3*r.end).toISOString():null}return t.alert["transit_realtime.mercury_alert"]&&(e=new Date(1e3*t.alert["transit_realtime.mercury_alert"].created_at).toISOString()),{startDate:n,endDate:i,creationDate:e}}(f),c=Object.assign({id:f.id,statusSummary:a,statusDescription:s,statusTitle:o,priority:u,direction:n,originalStatus:f},l);h.push(c),_.push(f.id)}catch(d){console.log(f.id,d)}})}),0<h.length&&(p.statusDetails=h),r.push(p)}),r});function m(){var e=[],t=[];for(let t=0;t<this.lines.length;t++){this.lines[t].statusDetails.sort(function(t,e){return e.priority-t.priority});var r=this.toDashedCase(this.lines[t].statusDetails[0].statusSummary);e[r]||(e[r]={status:this.lines[t].statusDetails[0].statusSummary,priority:this.lines[t].statusDetails[0].priority}),e[r].lines||(e[r].lines=[]),e[r].lines.push(this.lines[t])}let n="";for(n in e)t.push(e[n]);return 0<t.length&&t.sort(function(t,e){return e.priority-t.priority}),t}const h=function(t){t.sort(function(t,e){return t.sortOrder-e.sortOrder})};function g(n,t){var e=t.subwayLines;n.lastUpdated=t.lastUpdated,n.subwayLines.length||n.goodServiceLines.length?_.each(e,function(t){var e=_.findIndex(n.goodServiceLines,{id:t.id}),r=_.findIndex(n.subwayLines,{id:t.id});-1<e?n.goodServiceLines.splice(e,1):-1<r&&n.subwayLines.splice(r,1),(t.statusDetails?n.subwayLines:n.goodServiceLines).push(t)}):(_.each(e,function(t){(t.statusDetails?n.subwayLines:n.goodServiceLines).push(t)}),t.subwayLines.length&&(n.allSubwayLines=t.subwayLines)),h(n.subwayLines),h(n.goodServiceLines)}function b(r,t){t=t.busRoutes;let e=[];t.forEach(function(t){t.statusDetails&&(t.statusDetails.sort(function(t,e){return e.priority-t.priority}),e.push(t))}),r.alertedBuses=e,r.busRoutes.length?_.each(t,function(t){var e=_.find(r.busRoutes,{routeId:t.routeId});e&&(e.statusDetails=t.statusDetails)}):r.busRoutes=t}function L(r,t){t=t.railLines;t.forEach(function(t){t.statusDetails&&t.statusDetails.sort(function(t,e){return e.priority-t.priority})}),r.mnrLines.length&&r.longIslandLines.length?_.each(t,function(t){var e;"LI"===t.agency?(e=_.find(r.longIslandLines,{routeId:t.routeId}))&&(e.statusDetails=t.statusDetails):"MNR"!==t.agency&&"NJT"!==t.agency||(e=_.find(r.mnrLines,{routeId:t.routeId}))&&(e.statusDetails=t.statusDetails)}):(r.longIslandLines=_.filter(t,{agency:"LI"}),r.mnrLines=_.filter(t,function(t){return"MNR"===t.agency||"NJT"===t.agency}))}function v(t){return t.toLowerCase().replace(/\s/g,"-")}function D(t){return"string"==typeof t&&!(t=t.replace(/(<p style="min-height:10px"><\/p>|<p><\/p>)+$/g,"")).indexOf("<p>")&&~t.indexOf("</p>",t.length-4)?t.substring(3,t.length-4):t}function S(t){return t.originalStatus.alert["transit_realtime.mercury_alert"].human_readable_active_period}function A(t){return t.originalStatus.alert["transit_realtime.mercury_alert"].human_readable_active_period.translation[0].text}function w(t){return t.inService?t.statusDetails&&t.statusDetails.length?t.statusDetails[0].statusSummary:"On or Close":t.statusDetails&&t.statusDetails.length?t.statusDetails[0].statusSummary:"No Scheduled Service"}function I(t,e){var r="";return r=e.length?(r+="<hr>"+t+"<br>")+e.map(function(t){var e=t.statusDetails&&t.statusDetails.length;return"<hr>"+(e?"<details><summary>":"")+"<font color="+t.color+">"+t.route+"</font> "+w(t)+(e?"</summary>"+t.statusDetails.map(function(t){return"<b>"+t.statusSummary+"</b><br>"+D(t.statusTitle)+(S(t)?"<br>"+A(t):"")+"<br>"+(t.statusDescription?D(t.statusDescription):"")}).join("<hr>")+"</details>":"")}).join(""):r}var R=0,N,C;function E(t){t=eval("0,"+t),t=mapper.buildServiceRoutes(t),N=t,C&&O()}function M(t){t=eval("0,"+t),C=t.entity,N&&O()}function O(){var t,e,r,n="",i=C,i={busRoutes:p(N.busRoutes,i),railLines:p(N.railLines,i),subwayLines:p(N.subwayLines,i)},a={mnrLines:[],busRoutes:[],subwayLines:[],componentRoutes:[],longIslandLines:[],goodServiceLines:[],favorites:null,lastUpdated:null,lineListError:null,allSubwayLines:null,subwayLineGroups:null,serviceStatusLoading:!1,alertedBuses:[]},s=(g(a,i),L(a,i),b(a,i),m.call({lines:a.subwayLines,toDashedCase:v}));for(t in s){var o=s[t];for(r in n+="<hr>"+o.status+"<br>",o=o.lines)n=(n+="<details><summary>"+u("["+(e=o[r]).name+"]",e.name)+"</summary>")+e.statusDetails.map(function(t){return"<b>"+t.statusSummary+"</b><br>"+D(t.statusTitle).replace(/\[(\w+)\]/g,u)+(S(t)?"<br>"+A(t):"")+"<br>"+(t.statusDescription?D(t.statusDescription).replace(/\[(\w+)\]/g,u):"")}).join("<hr>")+"</details>"}if((s=a.goodServiceLines).length)for(r in n+="<hr>No Active Alerts<br>",s)n+=u("["+(e=s[r].name)+"]",e)+" ";n=(n+=I("Metro-North Railroad",a.mnrLines))+I("Long Island Rail Road",a.longIslandLines),document.body.innerHTML+=n,N=C=void 0}function T(t,e,r){var x=this.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");try{x.open("get",t,1),x.onreadystatechange=function(){4==x.readyState&&(200==x.status?"withCredentials"in x||x.getResponseHeader("Date")?(e?M:E)(x.responseText):T(t,e,1):alert("error HTTP status "+x.status))},r&&x.setRequestHeader("if-MODIFIED-since",new Date(0)),x.setRequestHeader("accept","application/json"),x.send()}catch(n){(n=document.createElement("script")).src="//api.allorigins.win/get?url=http%3A"+escape(t+"&_=")+(new Date).getTime()+"&callback="+(e?"F":"j"),1<(i=document.getElementsByTagName("head")[0]).childNodes.length&&i.removeChild(i.childNodes[1]),i.appendChild(n)}}function j(t){E(t.contents)}function F(t){M(t.contents)}</script>