<meta content=0 name=mobileoptimized><meta content=no-referrer name=referrer><link href="//collector-otp-prod.camsys-apps.com/realtime/gtfsrt/ALL/alerts?type=json&apikey=qeqy84JE7hUKfaI0Lxm2Ttcm6ZA0bYrP"rel=preload as=fetch crossorigin><link href=routes.json rel=preload as=fetch><link href=//collector-otp-prod.camsys-apps.com rel=dns-prefetch><link href=//collector-otp-prod.camsys-apps.com rel=preconnect>No javascript<script>var u,t="/routes.json",e="//collector-otp-prod.camsys-apps.com/realtime/gtfsrt/ALL/alerts?type=json&apikey=qeqy84JE7hUKfaI0Lxm2Ttcm6ZA0bYrP",r="<a href=javascript:history.back()>Back</a> Refresh[<a href=javascript:a()>Fast</a> <a href=\"javascript:location.replace('status.htm')\">Slow</a>] <a href="+t+">RawR</a> <a href="+e+">RawA</a><br>",l,c;function a(){A(t),A(e,1),document.body.innerHTML=r}function p(t,e){e={1:"EE352E",2:"EE352E",3:"EE352E",4:"00933C",5:"00933C","5X":"00933C",6:"00933C","6X":"00A65C",7:"B933AD","7X":"B933AD",A:"2850AD",B:"FF6319",C:"2850AD",D:"FF6319",E:"2850AD",F:"FF6319",FX:"FF6319",G:"6CBE45",GS:"6D6E71",J:"996633",L:"A7A9AC",M:"FF6319",N:"FCCC0A",Q:"FCCC0A",R:"FCCC0A",W:"FCCC0A",Z:"996633"}[e||t];return e?"<font color="+e+">"+t+"</font>":t}function n(t){for(var r,a,n,i={},s=Math.round(Date.now()/1e3),e=0;e<t.length;e++){r=t[e],a=!1;try{r.alert["transit_realtime.mercury_alert"]&&r.alert.active_period&&(n=r.alert["transit_realtime.mercury_alert"].hasOwnProperty("display_before_active"),~r.id.indexOf("planned_work")&&!n?a=!1:r.alert.active_period.forEach(function(t){var e;t.start&&!a&&(e=t.start,n&&(e-=r.alert["transit_realtime.mercury_alert"].display_before_active),e<s&&(a=!0),t.end)&&s>t.end&&(a=!1)}))}catch(o){console.log(o)}a&&r.alert.informed_entity.forEach(function(t){var e;(e=t.route_id)&&(e=e.toLowerCase(),(t=(t=i[t.agency_id]=i[t.agency_id]||{})[e]=t[e]||[]).push(r))})}return i}function h(t){for(var e,r=!1,a=!1,n=0;n<t.length;n++){if("en-html"===(e=t[n]).language)return e.text;"en"===e.language?r=e.text:""===e.language&&(a=e.text)}return r||a||!1}function f(t,e){var r=[];return t.forEach(function(f){var t=f.mode,d=("SUBWAY"===t?f.name:"RAIL"===t?~f.routeId.indexOf("NJT")?f.routeId.replace("_",":"):f.routeId.split("_")[1]:"BUS"===t?f.id.split(":")[1]:f.shortName).toLowerCase();e[f.agency]&&e[f.agency][d]&&0<(t=e[f.agency][d].map(function(t){var e,r,a,n,i,s=1,o=t.alert.informed_entity.find(function(t){return t.agency_id===f.agency&&t.route_id.toLowerCase()==d?1:0}),u=(o.trip&&(s=o.trip.direction_id),l="No Status Summary",l=(u=t).alert["transit_realtime.mercury_alert"]?u.alert["transit_realtime.mercury_alert"].alert_type:l),l=!!(l=(l=t).alert.description_text)&&h(l.translation),c=!!(c=(c=t).alert.header_text)&&h(c.translation),o=(p=-10,p=(o=o)["transit_realtime.mercury_entity_selector"]&&o["transit_realtime.mercury_entity_selector"].sort_order?(p=o["transit_realtime.mercury_entity_selector"].sort_order.split(":"))[2]?+p[2]:100:p),p=(i=n=p=null,(e=t).alert.active_period&&(r=Math.round(Date.now()/1e3),a=!1,e.alert.active_period.forEach(function(t){t.start&&(r>t.start&&(a=t),t.end)&&r>t.end&&(a=!1)}),p=a.start?new Date(1e3*a.start).toISOString():null,n=a.end?new Date(1e3*a.end).toISOString():null),{startDate:p,endDate:n,creationDate:i=e.alert["transit_realtime.mercury_alert"]?new Date(1e3*e.alert["transit_realtime.mercury_alert"].created_at).toISOString():i});return Object.assign({id:t.id,statusSummary:u,statusDescription:l,statusTitle:c,priority:o,direction:s,originalStatus:t},p)})).length&&(f.statusDetails=t),r.push(f)}),r}function d(t){for(var e,r,a,n={},i=[],s=0;s<t.length;s++)(e=t[s]).statusDetails.sort(function(t,e){return e.priority-t.priority}),((r=n[r=(a=e.statusDetails[0]).statusSummary.toLowerCase().replace(/\s/g,"-")]=n[r]||{status:a.statusSummary,priority:a.priority}).lines=r.lines||[]).push(e);for(r in n)i.push(n[r]);return i.sort(function(t,e){return e.priority-t.priority}),i}function i(t){t.sort(function(t,e){return t.sortOrder-e.sortOrder})}function m(t,e){var r=t.subwayLines,a=t.goodServiceLines;t.lastUpdated=e.lastUpdated,(t.allSubwayLines=e.subwayLines).forEach(function(t){(t.statusDetails?r:a).push(t)}),i(r),i(a)}function g(t,e){var r=t.alertedBuses;(t.busRoutes=e.busRoutes).forEach(function(t){t.statusDetails&&(t.statusDetails.sort(function(t,e){return e.priority-t.priority}),r.push(t))})}function _(t,e){var r=t.longIslandLines,a=t.mnrLines;e.railLines.forEach(function(t){("LI"===t.agency?r:a).push(t),t.statusDetails&&t.statusDetails.sort(function(t,e){return e.priority-t.priority})})}function v(t){return"string"==typeof t&&!(t=t.replace(/(<p style="min-height:10px"><\/p>|<p><\/p>)+$/g,"")).indexOf("<p>")&&~t.indexOf("</p>",t.length-4)?t.slice(3,-4):t}function b(t){return t.originalStatus.alert["transit_realtime.mercury_alert"].human_readable_active_period}function w(t){return h(t.originalStatus.alert["transit_realtime.mercury_alert"].human_readable_active_period.translation)}function s(t){return t.statusDetails&&t.statusDetails.length?t.statusDetails[0].statusSummary:t.inService?"On or Close":"No Scheduled Service"}function D(t,e){var r="";return r=e.length?(r+="<hr>"+t+"<br>")+e.map(function(t){var e=t.statusDetails&&t.statusDetails.length;return"<hr>"+(e?"<details><summary>":"")+"<font color="+t.color+">"+t.route+"</font> "+s(t)+(e?"</summary>"+t.statusDetails.map(function(t){return"<b>"+t.statusSummary+"</b><br>"+v(t.statusTitle)+(b(t)?"<br>"+w(t):"")+"<br>"+(t.statusDescription?v(t.statusDescription):"")}).join("<hr>")+"</details>":"")}).join(""):r}function o(t){l="object"==typeof(t=t.contents||t)?t:this.JSON?JSON.parse(t):eval("0,"+t),c&&L()}function S(t){c=n(("object"==typeof(t=t.contents||t)?t:this.JSON?JSON.parse(t):eval("0,"+t)).entity),l&&L()}function L(){for(var t,e,r=(new Date).toLocaleTimeString("en-US")+(u?" via JSONP":" via CORS")+"<br>",a={busRoutes:f(l.busRoutes,c),railLines:f(l.railLines,c),subwayLines:f(l.subwayLines,c)},n={mnrLines:[],busRoutes:[],subwayLines:[],componentRoutes:[],longIslandLines:[],goodServiceLines:[],favorites:null,lastUpdated:null,lineListError:null,allSubwayLines:null,subwayLineGroups:null,serviceStatusLoading:!1,alertedBuses:[]},i=(m(n,a),_(n,a),g(n,a),d(n.subwayLines)),s=0;s<i.length;s++){var o=i[s];for(r+="<hr>"+o.status+"<br>",o=o.lines,e=0;e<o.length;e++)r=(r+="<details><summary>"+p("["+(t=o[e]).name+"]",t.name)+"</summary>")+t.statusDetails.map(function(t){return"<b>"+t.statusSummary+"</b><br>"+v(t.statusTitle).replace(/\[(\w+)\]/g,p)+(b(t)?"<br>"+w(t):"")+"<br>"+(t.statusDescription?v(t.statusDescription).replace(/\[(\w+)\]/g,p):"")}).join("<hr>")+"</details>"}if((i=n.goodServiceLines).length)for(r+="<hr>No Active Alerts<br>",s=0;s<i.length;s++)r+=p("["+(t=i[s].name)+"]",t)+" ";r=(r=(r+=D("Metro-North Railroad",n.mnrLines))+D("Long Island Rail Road",n.longIslandLines))+D("Bus",n.alertedBuses.sort(function(t,e){return t.shortName<e.shortName?-1:1})),document.body.innerHTML+=r,l=c=void 0}function A(t,e,r){var x=this.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");try{if(u)throw 0;x.open("get",t,1);try{x.responseType="json"}catch(a){}x.onreadystatechange=function(){4==x.readyState&&(200==x.status?"withCredentials"in x||x.getResponseHeader("Date")?(e?S:o)(x.response):A(t,e,1):alert("error HTTP status "+x.status))},r&&x.setRequestHeader("if-modified-since",new Date(0)),x.setRequestHeader("accept","application/json"),x.send()}catch(n){(n=document.createElement("script")).src="//api.allorigins.win/get?url=http%3A"+escape(t+"&_=")+(new Date).getTime()+"&callback="+(e?"S":"o"),1<(u=document.getElementsByTagName("head")[0]).childNodes.length&&u.removeChild(u.childNodes[1]),u.appendChild(n)}}a(),"function"!=typeof Object.assign&&(Object.assign=function(t,e){"use strict";if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(t),a=1;a<arguments.length;a++){var n=arguments[a];if(null!=n)for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r}),Array.prototype.find||(Array.prototype.find=function(t){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof t)throw new TypeError("callback must be a function");for(var e=Object(this),r=e.length>>>0,a=arguments[1],n=0;n<r;n++){var i=e[n];if(t.call(a,i,n,e))return i}}),Array.prototype.filter||(Array.prototype.filter=function(t){"use strict";if(null==this)throw new TypeError;var e,r,a,n,i=Object(this),s=i.length>>>0;if("function"!=typeof t)throw new TypeError;for(e=[],r=arguments[1],a=0;a<s;a++)a in i&&(n=i[a],t.call(r,n,a,i))&&e.push(n);return e}),Array.prototype.map||(Array.prototype.map=function(t,e){var r,a,n;if(null==this)throw new TypeError(" this is null or not defined");var i,s=Object(this),o=s.length>>>0;if("function"!=typeof t)throw new TypeError(t+" is not a function");for(e&&(r=e),a=Array(o),n=0;n<o;)n in s&&(i=s[n],i=t.call(r,i,n,s),a[n]=i),n++;return a}),Array.prototype.forEach||(Array.prototype.forEach=function(t,e){"use strict";for(var r=0,a=this.length;r<a;++r)r in this&&t.call(e,this[r],r,this)}),Date.now||(Date.now=function E(){return(new Date).getTime()}),Date.prototype.toISOString||(Date.prototype.toISOString=function(){var t=1+this.getMonth(),e=this.getDay();return this.getFullYear()+"-"+(t<10?"0"+t:t)+"-"+(e<10?"0"+e:e)})</script>